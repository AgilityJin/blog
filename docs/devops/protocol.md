---
title: HTTP/HTTPS协议
date: 2020-08-19
categories:
  - 系统运维
tags:
  - http
  - https
---

## HTTP/HTTPS是什么

超文本传输协议,用于网络中数据的通信交换.http协议直接与TCP通信,https基于http,但是与SSL/TLS加密层进行通信,由SSL与TCP进行通讯,**HTTP加上加密处理和认证以及完整性保护后即是HTTPS**。

### 拓普: HTTPS为什么要基于SSL/TLS协议

SSL/TLS协议采用三种算法: 非对称加密,对称加密,散列算法.

1. 先使用非对称加密进行交换密钥,第三方无私钥无法获取公钥内容,此算法方式可以实现1vN.
2. 然后使用对称加密对内容加密,使得客户端具有解密报文内容的能力,不同的客户端密钥也是不相同的.
3. 使用散列算法进行数据完整性校验,MD5 SHA 函数不可逆,输出的内容长度固定.

## HTTP的特点&HTTPS解决了HTTP哪些问题

### http的特点

* 拥有客户端/服务器模式
* 简单快速: 规模小,通信快
* 灵活: 允许传输任意类型数据,通过Content-Type 标记
* 无连接: 每次只处理一个请求,完成即断开
* 无状态: 对事务没有记忆能力,无法对之前的请求进行记忆.

### https解决了http哪些问题

* 隐私性: http本身不具备加密能力,通信使用明文发送.而https使用密钥对,一个连接生成一个唯一密钥,采取对称加密,第三方无法解密.
* 完整性: http无法对内容的完整性进行校验,中间如果被篡改无法感知.
* 身份认证: http不会对通信方进行确认,任何人都可以发起请求并得到响应(未限制ip的前提下),

### HTTPS存在的问题

* 门槛较高,需要购买权威CA颁发的SSL证书,购买到部署都会增加耗时
* 性能消耗大于HTTP,加密通信会消耗更多的CPU及内存

#### 解决方法

将CA证书部署在SLB或CDN,进行适当的性能优化即可.

## HTTPS的工作流

1. Client(客户端)向Server(服务端)443端口发起https请求
2. Server收到并返回CA(公钥证书)给Client
3. Client递归验证CA所有信息,通过则继续,否则发出警告
4. Client利用伪随机数生成器生成加密所使用的对称密钥(会话级密钥),利用公钥对该密钥进行加密并发送给Server
5. Server使用私钥解密得到会话密钥,双方在此得到了对称密钥.
6. 此后Client与Server就可以进行通信,基于对称密钥对通信内容加解密.
